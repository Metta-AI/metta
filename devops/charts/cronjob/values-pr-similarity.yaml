# PR similarity cache cronjob specific values
# Runs once daily at midnight to refresh the PR embedding cache

schedule: "0 0 * * *"

image:
  name: pr-similarity-cache

# Command to refresh PR similarity cache
# Uses our lean Docker image with pre-installed dependencies
# Container working directory is /app with PYTHONPATH=/app
# Dependencies (numpy, google-genai, boto3) are pre-installed in the image
command:
  - python
  - mcp_servers/pr_similarity/build_cache.py
  - --download-from-s3

serviceAccount:
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::751442549699:role/pr-similarity-cache-cronjob

# No RBAC needed - only requires AWS IAM permissions via serviceAccount annotation
# The cronjob needs:
# - S3 access for cache storage
# - Secrets Manager for API keys (GEMINI_API_KEY, GITHUB_TOKEN)
rbac:
  enabled: false

# Datadog metric tagging
datadog:
  service: "pr-similarity-cache-refresh"
