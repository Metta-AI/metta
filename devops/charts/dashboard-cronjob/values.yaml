schedule: "*/15 * * * *"  # Run every 15 minutes

image:
  registry: 751442549699.dkr.ecr.us-east-1.amazonaws.com
  name: softmax-dashboard
  pullPolicy: Always
  tag: "latest"

# Command to run all collectors
# Uses the new modular collector architecture
# Container working directory is /app (lean collector image)
# Use absolute path because uv run resolves paths relative to package directories
command: ["python", "/app/devops/datadog/scripts/run_all_collectors.py"]

serviceAccount:
  create: true
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::751442549699:role/dashboard-cronjob

resources:
  requests:
    cpu: 100m
    memory: 2Gi
  limits:
    cpu: 500m
    memory: 2Gi

# Datadog metric tagging (for organizing metrics in Datadog)
datadog:
  env: "production"
  service: "datadog-collectors"  # Changed from github-collector to reflect all collectors
  site: "datadoghq.com"

# GitHub configuration
github:
  org: "PufferAI"
  repo: "metta"

# Asana configuration (workspace and project IDs are not secrets)
asana:
  workspaceGid: "1209016784099267"  # Company workspace
  bugsProjectGid: "1210062854657778"  # Bugs project

# Kubernetes configuration
kubernetes:
  clusterName: "main"  # Cluster name for metric tagging

# CronJob configuration
successfulJobsHistoryLimit: 3
failedJobsHistoryLimit: 3
concurrencyPolicy: Forbid  # Don't allow concurrent executions
restartPolicy: OnFailure
backoffLimit: 3
