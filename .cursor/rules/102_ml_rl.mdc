---
description: ML/RL patterns for Metta AI
globs: ["metta/**/*.py", "tests/**/*.py", "tools/**/*.py"]
alwaysApply: false
---

# ML/RL Patterns

## Core components
- PolicyStore - checkpoint management
- MettaAgent - single GPU
- DistributedMettaAgent - multi-GPU

## Policy URIs
- `file://./path/to/checkpoint`
- `wandb://run/name` or `wandb://entity/project/model/name:version`

## Device hints
- Use explicit `torch.device` type hints
- macOS: `device=cpu` (no CUDA)