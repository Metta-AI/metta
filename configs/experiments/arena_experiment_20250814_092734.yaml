# @package _global_
defaults:
- ../common
- ../agent/fast
- ../trainer/trainer
- ../sim/arena
- ../wandb/metta_research
- _self_
seed: 1
py_agent: null
train_job:
  map_preview_uri: s3://softmax-public/training_runs/${run}/map_preview.json.z
  evals: ${sim}
trainer:
  total_timesteps: 10000000
  ppo:
    clip_coef: 0.1
    ent_coef: 0.01
    gae_lambda: 0.916
    gamma: 0.977
    max_grad_norm: 0.5
    vf_clip_coef: 0.1
    vf_coef: 0.5
    l2_reg_loss_coef: 0
    l2_init_loss_coef: 0
    norm_adv: true
    clip_vloss: true
    target_kl: null
  optimizer:
    type: adam
    learning_rate: 0.0003
    beta1: 0.9
    beta2: 0.999
    eps: 1.0e-12
    weight_decay: 0
  prioritized_experience_replay:
    prio_alpha: 0.0
    prio_beta0: 0.6
  vtrace:
    vtrace_rho_clip: 1.0
    vtrace_c_clip: 1.0
  zero_copy: true
  require_contiguous_env_ids: false
  verbose: true
  batch_size: 2048
  minibatch_size: 512
  bptt_horizon: 64
  update_epochs: 1
  scale_batches_by_world_size: false
  cpu_offload: false
  compile: false
  compile_mode: reduce-overhead
  profiler:
    interval_epochs: 10000
    profile_dir: ${run_dir}/torch_traces
  forward_pass_minibatch_target_size: 4096
  async_factor: 2
  hyperparameter_scheduler:
    learning_rate_schedule: null
    ppo_clip_schedule: null
    ppo_ent_coef_schedule: null
    ppo_vf_clip_schedule: null
    ppo_l2_reg_loss_schedule: null
    ppo_l2_init_loss_schedule: null
  kickstart:
    teacher_uri: null
    action_loss_coef: 1
    value_loss_coef: 1
    anneal_ratio: 0.65
    kickstart_steps: 1000000000
    additional_teachers: null
  num_workers: 4
  env: null
  curriculum: env/mettagrid/curriculum/arena/learning_progress
  env_overrides: {}
  initial_policy:
    uri: null
    type: top
    range: 1
    metric: epoch
    filters: {}
  checkpoint:
    checkpoint_interval: 60
    wandb_checkpoint_interval: 300
    checkpoint_dir: ${run_dir}/checkpoints
  simulation:
    evaluate_interval: 300
    replay_dir: ${run_dir}/replays
    evaluate_remote: true
    evaluate_local: true
    skip_git_check: false
    git_hash: null
  grad_mean_variance_interval: 0
bypass_mac_overrides: false
run_name_pattern: null
cmd: train
