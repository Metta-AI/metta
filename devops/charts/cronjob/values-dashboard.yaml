# Dashboard cronjob specific values
# Runs every 15 minutes to collect and push metrics to Datadog

schedule: "*/15 * * * *"

image:
  name: softmax-dashboard

# Command to run all collectors
# Uses the new modular collector architecture
# Container working directory is /app (lean collector image)
# Use absolute path because uv run resolves paths relative to package directories
command: ["python", "/app/devops/datadog/scripts/run_all_collectors.py"]

serviceAccount:
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::751442549699:role/dashboard-cronjob

# Enable RBAC for Kubernetes API access (needed for KubernetesCollector)
rbac:
  enabled: true
  rules:
    # Kubernetes collector needs to read pods and deployments
    - apiGroups: [""]
      resources: ["pods"]
      verbs: ["get", "list"]
    - apiGroups: ["apps"]
      resources: ["deployments"]
      verbs: ["get", "list"]
    # Kubernetes collector needs to read pod metrics from metrics-server
    - apiGroups: ["metrics.k8s.io"]
      resources: ["pods"]
      verbs: ["get", "list"]

# Datadog metric tagging
datadog:
  service: "datadog-collectors"

# GitHub configuration
github:
  org: "PufferAI"
  repo: "metta"

# Asana configuration (workspace and project IDs are not secrets)
asana:
  workspaceGid: "1209016784099267"  # Company workspace
  bugsProjectGid: "1210062854657778"  # Bugs project

# Kubernetes configuration
kubernetes:
  clusterName: "main"  # Cluster name for metric tagging
