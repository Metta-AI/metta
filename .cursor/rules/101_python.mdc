---
description: Python and ML/RL coding standards
globs: ["*.py"]
alwaysApply: false
---

# Python Standards

## Imports
- At file top, never inside functions
- Order: stdlib → third-party → local, blank lines between

## Types
- Always annotate function params
- Modern syntax: `list[str]`, `type | None`
- Annotate returns for public APIs, complex logic

## Classes
- Private: `_name` (internal), Public: no `_` (API only)
- Properties: `@property` for computed values
- Tests can access `_private` members

## ML/RL patterns
- PolicyStore - checkpoint management
- MettaAgent/DistributedMettaAgent
- Policy URIs: `file://./path` or `wandb://run/name`
- Use explicit `torch.device` hints, macOS: `device=cpu`