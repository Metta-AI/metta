# @package _global_
# Working protein sweep - 1-minute end-to-end test
# Based on successful test examples and protein_simple.yaml structure

# Limit to reasonable number of rollouts for 1-minute test
rollout_count: 3  # Stop after 3 experiments (~1 minute total)
num_samples: 1    # Only 1 training run per rollout for fast testing

sweep:
  parameters:
    # Core learning parameter - most critical for fast convergence
    trainer.learning_rate:
      min: 0.0001
      max: 0.01
      mean: 0.001
      scale: 1
      distribution: log_normal

    # Batch size - power of 2 for compatibility with minibatch_size
    trainer.batch_size:
      min: 32
      max: 256
      mean: 64
      scale: 1
      distribution: uniform_pow2

    # Minibatch size - power of 2 for GPU efficiency
    trainer.minibatch_size:
      min: 8
      max: 32
      mean: 16
      scale: 1
      distribution: uniform_pow2

    # BPTT horizon - power of 2 for memory efficiency
    trainer.bptt_horizon:
      min: 4
      max: 16
      mean: 8
      scale: 1
      distribution: uniform_pow2

    # Forward pass minibatch - power of 2 for GPU efficiency
    trainer.forward_pass_minibatch_target_size:
      min: 8
      max: 32
      mean: 16
      scale: 1
      distribution: uniform_pow2

    # Discount factor - narrow range for stability
    trainer.gamma:
      min: 0.95
      max: 0.999
      mean: 0.99
      scale: 1
      distribution: uniform

  # Protein optimizer metadata
  metric: reward
  goal: maximize

  # 1-minute training settings
  trainer:
    total_timesteps: 2048            # ~20 seconds per run
    evaluate_interval: 512           # Evaluate every 512 steps
    checkpoint_interval: 512         # Checkpoint every 512 steps

    # Speed optimizations
    update_epochs: 1                 # Single update epoch
    num_steps: 128                   # Reasonable rollouts

  # Fast environment settings
  env:
    game:
      max_steps: 64                  # Short episodes
      objects:
        altar:
          hp: 10                     # Reasonable interactions
          cooldown: 5
