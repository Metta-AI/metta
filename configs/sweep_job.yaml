# Sweep job configuration with automatic phase progression
#
# This configuration automatically switches between different sweep configs
# based on the number of completed runs:
#   - Runs 1-80: phase1_explore_cheap (fast, wide exploration)
#   - Runs 81-160: phase2_exploit_medium (medium cost, exploitation)
#   - Runs 161+: phase3_final_expensive (expensive, final optimization)
#
# To use a single-phase sweep instead, override with:
#   sweep=full or sweep=simple

defaults:
  - common
  - wandb: metta_research
  - sweep: full # Default sweep config (will be overridden by phases)
  # Load all phase sweep configs with specific names
  - sweep@phase1_config: phase1_explore_cheap
  - sweep@phase2_config: phase2_exploit_medium
  - sweep@phase3_config: phase3_final_expensive
  - _self_

sweep_name: ??? # Will be set via command line override

settings:
  max_consecutive_failures: 5
  rollout_retry_delay: 5
  max_observations_to_load: 250
  sweep_server_uri: https://api.observatory.softmax-research.net

  # Reference the loaded configs
  phase_schedule:
    - phase: 1
      num_runs: 80
      sweep: ${phase1_config} # Reference the loaded config
    - phase: 2
      num_runs: 80
      sweep: ${phase2_config} # Reference the loaded config
    - phase: 3
      num_runs: 10000
      sweep: ${phase3_config} # Reference the loaded config

# Otherwise common will mess with us
run: null

sim_name: arena
sweep_job_overrides:
  trainer:
    curriculum: /env/mettagrid/arena/basic_easy_shaped
    simulation:
      evaluate_remote: false
      evaluate_local: true
      replay_dir: "" # No replays for sweeps

cmd: sweep
