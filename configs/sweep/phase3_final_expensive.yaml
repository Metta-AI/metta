# Phase 3: Final Push with Expensive Runs (Runs 201-250)
# Focus: Test best configurations with high compute
# Goal: Achieve peak performance with best hyperparameters

protein:
  acquisition_fn: ei # EI for exploitation-focused with some exploration
  beta_ucb: 1.5 # Low exploration parameter
  xi_ei: 0.001 # Very low exploration for EI
  num_random_samples: 0 # No random exploration
  max_suggestion_cost: 10800 # 3 hours - expensive runs OK
  expansion_rate: 0.2 # Some cost variation
  global_search_scale: 0.5 # Very focused search
  random_suggestions: 128 # Smaller candidate pool
  suggestions_per_pareto: 128 # Many suggestions from best points
  seed_with_search_center: false
  phase: 3 # Phase identifier for logging

metric: heart.gained # Total hearts gained
goal: maximize
method: bayes
max_observations_to_load: 300 # Load Phase 1 & 2 results

parameters:
  trainer:
    # Same ranges as Phases 1 & 2 - only means change
    total_timesteps:
      distribution: int_uniform
      min: 100000000 # 100M - FIXED across all phases
      max: 5000000000 # 5B - FIXED across all phases
      mean: 3000000000 # 3B - bias toward expensive
      scale: auto

    batch_size:
      distribution: uniform_pow2
      min: 65536 # 2^16 - FIXED across all phases
      max: 1048576 # 2^20 - FIXED across all phases
      mean: 524288 # 2^19 - bias toward large
      scale: auto

    optimizer:
      learning_rate:
        distribution: log_normal
        min: 1e-5 # FIXED across all phases
        max: 1e-2 # FIXED across all phases
        mean: 3e-4 # Standard bias - let optimizer learn
        scale: auto

    ppo:
      gamma:
        distribution: uniform
        min: 0.95 # FIXED across all phases
        max: 0.999 # FIXED across all phases
        mean: 0.99 # Standard bias - let optimizer learn
        scale: auto

      gae_lambda:
        distribution: uniform
        min: 0.85 # FIXED across all phases
        max: 0.99 # FIXED across all phases
        mean: 0.95 # Standard bias - let optimizer learn
        scale: auto

      clip_coef:
        distribution: uniform
        min: 0.05 # FIXED across all phases
        max: 0.4 # FIXED across all phases
        mean: 0.2 # Standard bias - let optimizer learn
        scale: auto

      ent_coef:
        distribution: log_normal
        min: 1e-4 # FIXED across all phases
        max: 1e-2 # FIXED across all phases
        mean: 1e-3 # Standard bias - let optimizer learn
        scale: auto
