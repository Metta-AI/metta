# GitHub Actions hardware configuration
# Optimized for standard GitHub runners (2-4 CPU cores, limited GPU)

# Override environment variables for GitHub CI
env_vars:
  # CPU thread limits for GitHub runners
  OMP_NUM_THREADS: "2"
  MKL_NUM_THREADS: "2"
  OPENBLAS_NUM_THREADS: "2"
  
  # Memory optimizations for limited RAM
  PYTORCH_CUDA_ALLOC_CONF: "max_split_size_mb:64,garbage_collection_threshold:0.9"
  
  # Disable benchmark mode for reproducibility in CI
  TORCH_CUDNN_BENCHMARK: "0"
  
  # Enable CUDA debug for CI debugging
  CUDA_LAUNCH_BLOCKING: "1"

# Trainer overrides for limited resources
trainer:
  # Reduced batch sizes for GitHub runners
  batch_size: 8192  # Much smaller than default 524288
  minibatch_size: 1024  # Much smaller than default 16384
  forward_pass_minibatch_target_size: 512  # Reduced from 4096
  
  # Disable compilation for faster CI builds
  compile: false
  
  # Disable mixed precision for stability in CI
  use_mixed_precision: false
  grad_scaler_enabled: false
  
  # More frequent checkpointing for CI
  checkpoint:
    checkpoint_interval: 30  # Every 30 seconds instead of 60
    wandb_checkpoint_interval: 0  # Disable W&B uploads in CI
  
  # Reduce profiling overhead
  profiler:
    interval_epochs: 0  # Disable profiling in CI

# Environment configuration for limited resources
env:
  num_envs: 4  # Reduced from typical values
  
# Use serial vectorization for GitHub runners to avoid multiprocessing overhead
vectorization: serial
