# Example workflow showing how to handle external PRs
name: "Example: External PR Handling"
on:
  pull_request:

jobs:
  example-job:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      # Add this single step to automatically detect and configure for external PRs
      - name: Detect PR context
        uses: ./.github/actions/detect-pr-context
        with:
          has_secrets: ${{ secrets.SOME_SECRET != '' }}

      # Now you can use these patterns:

      # Pattern 1: Skip steps on external PRs
      - name: Upload to external service
        if: env.EXTERNAL_PR_MODE != 'true'
        run: echo "This only runs on internal PRs"

      # Pattern 2: Use config flags
      - name: Run tests
        run: |
          if [ "$EXTERNAL_PR_MODE" = "true" ]; then
            # External PR mode
            uv run tools/train.py wandb=off
          else
            # Internal PR mode with full services
            uv run tools/train.py
          fi

      # Pattern 3: Environment variables are automatically set
      # EXTERNAL_PR_MODE=true/false
      # WANDB_MODE=offline (on external PRs)
      # CODECOV_TOKEN=skip (on external PRs)
      # ASANA_API_KEY=skip (on external PRs)
